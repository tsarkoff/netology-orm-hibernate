# Задача «Безопасное приложение»
## Описание
Сегодня вы попрактикуетесь в обеспечении безопасности для приложений. Вы ограничите доступ к endpoint.
1. Возьмите любое из уже реализованных приложений на `Spring Boot`, где есть контроллер и не менее одного метода-обработчика запросов на разные endpoint.
2. Добавьте в приложение зависимость на `spring-boot-starter-security`.
3. Реализуйте класс-наследник `WebSecurityConfigurerAdapter` так, чтобы:
- пользователь логинился через стандартную форму логина от Spring;
- как минимум на один из endpoint вашего приложения можно было попасть без авторизации, а на все остальные — только после авторизации.
4. Запуште изменения в репозиторий и прикрепите ссылку на него в комментарий к домашнему заданию.

# 3. Инструкция к приложению по работе с Персонами с использованием JPA Repository
1. Запустить приложение (используется контейнер с Postgres)
2. Hibernate создаст таблицу Person
3. Использовать CRUD запросы из файла ./src/main/resources/requests.http
4. Выполнение запросов по очереди (запросы использует @EmbeddedId Human ID):
   - POST http://127.0.0.1:8080/person наполняет таблицу начальными данными
   - GET http://127.0.0.1:8080/person/1 возвращает Person по Human ID
   - GET http://127.0.0.1:8080/person?name=&surname= возвращает список Person по имени / фамилии
   - GET http://127.0.0.1:8080/person возвращает список список Person из базы
   - GET http://127.0.0.1:8080/person?name= возвращает список Person по имени
   - GET http://127.0.0.1:8080/person?surname= возвращает список Person по фамилии
   - GET http://127.0.0.1:8080/person/by-city?city= возвращает список Person по городу
   - GET http://127.0.0.1:8080/person/by-age?age= возвращает список Person с возрастом меньше указанного по убыванию
   - PUT http://127.0.0.1:8080/person/1/update-person-data обновляет поля только Person по Human ID
   - PUT http://127.0.0.1:8080/person/1/pure-update-person-human-data (без upsert) только обновляет все поля существующей Person через JPQL UPDATE   
   - PUT http://127.0.0.1:8080/person/1/reinsert-person-human (save) обновляет все поля Person или реинсёртит Person, если такой уже был по Human ID
   - DELETE http://127.0.0.1:8080/person/1 удаляет Person по Human ID
   - DELETE http://127.0.0.1:8080/person удаляет всех Person из БД

# 2. Задача «Слой DAO c JPA Repositories»
## Описание
Попрактикуемся в работе с JPA Repositories, переписав приложение для работы с БД [«Слой DAO c Hibernate»](../../hibernate/task1/README.md).
**Что нужно сделать**
1. Перепишите репозиторий для работы с БД на основе методов-запросов:
- чтобы у вашего репозитория были основные методы для `CRUD` операций;
- создайте метод, который будет принимать название города (`city`) и возвращать `Entity` из базы данных, которые соответствуют этому `city`;
- создайте метод, который будет принимать возраст (`age`) и возвращать `Entity` из базы данных, которые меньше переданного `age` и отсортированы по возрастанию;
- создайте метод, который будет принимать имя и фамилию (`name` и `surname`) и возвращать `Entity` из базы данных, которые соответствуют сочетанию `name` и `surname` и являются `Optional`.
2. Допишите недостающие методы контроллера в соответствии с появившимися новыми методами в репозитории.
3. Написанный код выложите в тот же репозиторий, что и для задачи [«Слой DAO c Hibernate»](../../hibernate/task1/README.md) на GitHub, только создайте под него другую ветку `jpa-repository` и прикрепите ссылку на неё в комментарий к домашнему заданию.

# 1. Использование приложения "Просмотр людей из Москвы"
**Пререквизиты**: приложение запускает контейнер postres, должен быть предустановлен Docker.
1. Запустить приложение (IntelliJ IDEA Ultimate 2024.1.4)
2. Открыть файл resources/request.http
3. Выплонить запрос наполнения БД данными : GET http://127.0.0.1:8080/persons/init
4. Выплонить запрос получения людей из Москвы : GET http://127.0.0.1:8080/persons/by-city?city=moscow
5. Полученные данные просмотреть в консоли выполнения запроса
   - Альтернатива: выполнить запрос GET http://127.0.0.1:8080/persons/by-city?city=moscow из браузера
---

# Задача «Слой DAO c Hibernate»

## Описание

Попрактикуемся в работе с Hibernate через Spring, параллельно закрепляя уже пройденные темы.

Вам надо написать приложение для работы с БД, используя средства Spring по конфигурации и работе с Hibernate, адаптировав таблицы из задания [«Таблица пользователей»](../../sql-basic/task/README.md).

**Что нужно сделать**

1. Создайте Spring Boot приложение с зависимостями на два стартера — `spring-boot-starter-data-jpa` и `spring-boot-starter-web`.

2. Создайте Entity, которая соответствует таблице из условий задачи [«Таблица пользователей»](../../sql-basic/task/README.md).

3. Напишите репозиторий для работы с БД.

- создайте класс и пометьте его аннотацией Repository, либо создайте бин репозитория в Java Config классе;
- правильно инжектируйте EntityManager;
- создайте метод `getPersonsByCity(String city)`, который будет принимать название города и возвращать ваше Entity из базы данных, соответствующие этому `city`. Сделать это можно, например, получив всех пользователей и отфильтровав их по городу.

4. Напишите контроллер с методом-обработчиком GET-метода запроса с маппингом на endpoint `/persons/by-city`. В query params запроса будет приходить строковый параметр `city`, который вам надо будет передавать дальше в репозиторий. То есть, ваш метод должен уметь обрабатывать запрос вида `localhost:8080/persons/by-city?city=Moscow`.
   Контроллер должен будет возвращать всех людей, которых он получит от репозитория.

5. Написанные код выложите в отдельный репозиторий на GitHub и прикрепите ссылку на него в комментарий к домашнему заданию.